

    Cybersecurity
Penetration Test Report Template










MegaCorpOne

Penetration Test Report

[SJam Securities], LLC





Confidentiality Statement

This document contains confidential and privileged information from MegaCorpOne Inc. (henceforth known as MegaCorpOne). The information contained in this document is confidential and may constitute inside or non-public information under international, federal, or state laws. Unauthorized forwarding, printing, copying, distribution, or use of such information is strictly prohibited and may be unlawful. If you are not the intended recipient, be aware that any disclosure, copying, or distribution of this document or its parts is prohibited.


Table of Contents

Confidentiality Statement	2
Contact Information	4
Document History	4
Introduction	5
Assessment Objective	5
Penetration Testing Methodology	6
Reconnaissance	6
Identification of Vulnerabilities and Services	6
Vulnerability Exploitation	6
Reporting	6
Scope	7
Executive Summary of Findings	8
Grading Methodology	8
Summary of Strengths	9
Summary of Weaknesses	9
Executive Summary Narrative	10
Summary Vulnerability Overview	11
Vulnerability Findings	12
MITRE ATT&CK Navigator Map	13



Contact Information

Company Name
[SJAM Securities], LLC
Contact Name
[Sadaf Jamal]
Contact Title
Penetration Tester
Contact Phone
555.224.2411
Contact Email
[Sadaf]@[SJam].com





Document History

Version
Date
Author(s)
Comments
001
24/02/2024
[Sadaf Jamal]






























Introduction

In accordance with MegaCorpOne’s policies, [SJAM], LLC (henceforth known as [SJAM]) conducts external and internal penetration tests of its networks and systems throughout the year. The purpose of this engagement was to assess the networks’ and systems’ security and identify potential security flaws by utilizing industry-accepted testing methodology and best practices. The project was conducted on a number of systems on MegaCorpOne’s network segments by [SJAM] during December of 2023.

For the testing, [SJAM] focused on the following:

Attempting to determine what system-level vulnerabilities could be discovered and exploited with no prior knowledge of the environment or notification to administrators.
Attempting to exploit vulnerabilities found and access confidential information that may be stored on systems.
Documenting and reporting on all findings.

All tests took into consideration the actual business processes implemented by the systems and their potential threats; therefore, the results of this assessment reflect a realistic picture of the actual exposure levels to online hackers. This document contains the results of that assessment.

Assessment Objective

The primary goal of this assessment was to provide an analysis of security flaws present in MegaCorpOne’s web applications, networks, and systems. This assessment was conducted to identify exploitable vulnerabilities and provide actionable recommendations on how to remediate the vulnerabilities to provide a greater level of security for the environment.

[SJAM] used its proven vulnerability testing methodology to assess all relevant web applications, networks, and systems in scope. 

MegaCorpOne has outlined the following objectives:

Table 1: Defined Objectives

Objective
Find and exfiltrate any sensitive information within the domain.
Escalate privileges to domain administrator.
Compromise at least two machines.





Penetration Testing Methodology


Reconnaissance 

[SJAM] begins assessments by checking for any passive (open source) data that may assist the assessors with their tasks. If internal, the assessment team will perform active recon using tools such as Nmap and Bloodhound.

Identification of Vulnerabilities and Services

[SJAM] uses custom, private, and public tools such as Metasploit, hashcat, and Nmap to gain perspective of the network security from a hacker’s point of view. These methods provide MegaCorpOne with an understanding of the risks that threaten its information, and also the strengths and weaknesses of the current controls protecting those systems. The results were achieved by mapping the network architecture, identifying hosts and services, enumerating network and system-level vulnerabilities, attempting to discover unexpected hosts within the environment, and eliminating false positives that might have arisen from scanning. 

Vulnerability Exploitation

[SJAM]’s normal process is to both manually test each identified vulnerability and use automated tools to exploit these issues. Exploitation of a vulnerability is defined as any action we perform that gives us unauthorized access to the system or the sensitive data. 

Reporting

Once exploitation is completed and the assessors have completed their objectives, or have done everything possible within the allotted time, the assessment team writes the report, which is the final deliverable to the customer.


Scope

Prior to any assessment activities, MegaCorpOne and the assessment team will identify targeted systems with a defined range or list of network IP addresses. The assessment team will work directly with the MegaCorpOne POC to determine which network ranges are in-scope for the scheduled assessment. 

It is MegaCorpOne’s responsibility to ensure that IP addresses identified as in-scope are actually controlled by MegaCorpOne and are hosted in MegaCorpOne-owned facilities (i.e., are not hosted by an external organization). In-scope and excluded IP addresses and ranges are listed below. 

IP Address/URL
Description
172.16.117.0/16
MCO.local
*.Megacorpone.com
MegaCorpOne internal domain, range and public website





Executive Summary of Findings

Grading Methodology

Each finding was classified according to its severity, reflecting the risk each such vulnerability may pose to the business processes implemented by the application, based on the following criteria:

Critical:	 Immediate threat to key business processes.
High:		 Indirect threat to key business processes/threat to secondary business processes.
Medium:	 Indirect or partial threat to business processes. 
Low:		 No direct threat exists; vulnerability may be leveraged with other vulnerabilities.
Informational:    No threat; however, it is data that may be used in a future attack.

As the following grid shows, each threat is assessed in terms of both its potential impact on the business and the likelihood of exploitation:





Summary of Strengths

While the assessment team was successful in finding several vulnerabilities, the team also recognized several strengths within MegaCorpOne’s environment. These positives highlight the effective countermeasures and defenses that successfully prevented, detected, or denied an attack technique or tactic from occurring. 

Network availability was ensured through mitigation strategy in place for denial of DDOS Attacks
Mapping network architecture allowed for no vulnerable open source data penetration 
Unauthorized access was prevented through utilizing atools like Metasploit/Hashcat/Nmap 
Forward-thinking defensive and offensive strategy
Vulnerabilities for mitigation are identified through current and continuing penetration testing

Summary of Weaknesses

[SJAM] successfully found several critical vulnerabilities that should be immediately addressed in order to prevent an adversary from compromising the network. These findings are not specific to a software version but are more general and systemic vulnerabilities.

Web Application is vulnerable to XSS and SQL payload injection
Credentials are being stored in HTML source code
Apache web server is outdated and vulnerable to multiple exploits
SLMail server is vulnerable to exploits which allow access to shell
Unauthorized access to password hashes allow for password cracking and privilege escalation
Credentials are displayed when doing a IP lookup
Potential vulnerabilities (open ports, IP addresses, etc.) when scanned
Open ports allow for file enumeration and unauthorized access



Executive Summary

SJAM Securities were able to locate and exfiltrate sensitive information, escalate our privileges to the Domain Administrator, and compromise at least two machines

Our tests revealed seven vulnerabilities. Allowing weak passwords is related to  majority of these vulnerabilities. Our testing enabled us to guess and use a weak password. We used it to access both a Linux and Windows 10 machine. We were then able to locate and exfiltrate other user names and passwords on those machines. 

Consequently, we were able to escalate our privileges to the highest level for both Linux and Windows. This allowed us to create backdoor access to the machines. This enabled us to continue to exploit them at will. This lead us to have access to the Domain controllers for Windows and hence, we were able to make lateral movements between machines. While additional mitigation strategies are available and outlined in detail later in this report, correcting this vulnerability is the key to reducing the majority of risks found. We continued our testing to reveal vulnerabilities in open ports that allow for backdoor access to be established. During our open source intelligence research, we were able to locate the IP addresses of MegaCorpOne’s DNS servers which makes them vulnerable to attack through those entry points. 

Furthermore, we did our research to discover that Megacorpone is open to LLMNR attacks. After running a Shodan report, we found that Megacorpone’s apache servers may potentially have some vulnerabilities. We did not specifically test these, but the CVE notices referenced in the report come from publicly reported security flaws. 
The Vulnerability Findings section of our report provides detail about each of the vulnerabilities we found. We also offer mitigation suggestions in it. Although there are some critical areas that need to be addressed, however most of our recommendations are easily achievable and cost-effective. 




Summary Vulnerability Overview


Vulnerability
Severity
Weak password on public web application
Critical
Port 21 (FTP) is open.
Critical
Admin Credentials in plain text
Critical
LLMNR
High
Privilege Escalation
High
IP addresses for three of Megacorpone’s domain servers are exposed.
Medium 
CVE Vulnerabilities
Medium







The following summary tables represent an overview of the assessment findings for this penetration test:

Scan Type
Total
Hosts
What hosts did you scan?

194.56.244.87 – www.megacorpone.com 172.22.117.100 – host machine 172.22.117.150 – Linux machine 172.22.117.20 – Windows10 machine 172.22.117.10 – WinDC01 – Domain Controller 
Ports
What ports did you scan?

21 FTP, 22 SSH, 80 HTTP, 443 HTTPS, 445 SMB, 139 RPC/SMB, 3389 RDP, 88 Kerberos 


Exploitation Risk
Total
Critical
3
High
2
Medium
2
Low
0




Vulnerability Findings

Weak Password on Public Web Application

Risk Rating: Critical

Description: 
The site vpn.megacorpone.com is used to host the Cisco AnyConnect configuration file for MegaCorpOne. This site is secured with basic authentication but is susceptible to a dictionary attack. [SJAM] was able to use a username gathered from OSINT in combination with a wordlist in order to guess the user’s password and access the configuration file.

Affected Hosts: vpn.megacorpone.com

Remediation: 

Set up two-factor authentication instead of basic authentication to prevent dictionary attacks from being successful.
Require a strong password complexity that requires passwords to be over 12 characters long, upper+lower case, & include a special character.
Reset the user thudson’s password.


[List any other vulnerabilities you found here. Feel free to go into as much detail (including technical detail) as you want.]

Vulnerability: Weak Passwords 
Risk Rating: critical 
Description: Megacorpone currently allows staff to use weak passwords. SJAM was able to determine one of those passwords. We used it to connect with a Linux machine and run a script file. If this had been a malicious script file it could have been used to damage the system and/or data which could be a cybersecurity concern. 

Consequently, when a connction was established, we were also able to escalate our access privileges to the root level and create backdoor access permitting us to return to the machine. We used the same weak password to perform a password spray exercise with Metasploit. We were able to gain access to both a Windows10 machine and to the Windows DomainController machine. We eventually escalated our privileges to the System and created a backdoor. The escalated access permissions also allowed us to locate additional user credentials. Affected hosts: vpn.megacorpone.com, 172.22.117.20 – Windows10 machine 172.22.117.10 – WinDC01 – Domain Controller 
Remediation: 
Require complex passwords with a minimum of eight characters, including upper and lower case letters, numbers and symbols 
Require passwords to be changed every 60-90 days  
Implement multi-factor authentication if possible

Vulnerability: Port 21 (FTP) is open 
Risk Rating: critical 
Description: A Zenmap scan revealed that port 21 is open on Windows machine 172.22.117.20. There are known vulnerabilities with this port that make them vulnerable to backdoor attacks. Backdoor attacks allow attackers to establish a persistent (ongoing) connection with the machine so that they can exploit its data. Affected hosts: Windows machine 172.22.117.20 

Remediation: 
Close port 21 
Correct weak password issue mentioned above 
Keep software updated 
Use advanced antivirus/antimalware and keep it up-to-date 
Use a firewall 

Vulnerability: Files with Administrative credentials in plain text 
Risk Rating: critical
Description: Using a malicious script in Metasploit along with the weak password that was discovered, we were able to connect to a Linux machine. While inside the machine, we were able to locate a file with administrative level credentials in plain view. We were then able to use that information to escalate our privileges within the machine to find additional user files. We were able to obtain the password information from those files and use it to create a backdoor through port 22 (ssh) on the Linux machine. This will allow us to continue to re-enter the machine. 
Affected hosts: 172.22.117.150 – Linux machine 
Remediation: Correct weak password issue 
Use secure password keeping software instead of writing down usernames and passwords, especially for staff with high level administrative privileges.  
Keep software updated 
Use advanced antivirus software and keep it up-to-date 
Use a firewall 

Vulnerability: LLMNR 
Risk Rating: High 
Description: LLMNR or Local Link Multicast Name Resolution is an older broadcast protocol that serves as a local backup for DNS. Attackers can take advantage of this by listening for LLMNR requests and spoofing a response causing users to provide them with credentials that will help them gain access to the network. We were able to simulate an LLMNR attack and obtain a new set of credentials we did not previously have. 
Affected hosts: 172.22.117.20 – Windows10 machine 
Remediation: 
Turn off LLMNR in the group policy editor  
Monitor traffic

Vulnerability: Privilege Escalation 
Risk Rating: High 
Description: Privilege escalation is an additional issue related to weak passwords. While resolving weak passwords should reduce the risk, taking action to specifically prevent escalation of privileges if access is gained, is also important. 
Affected hosts: 172.22.117.150 – Linux machine 172.22.117.20 – Windows10 machine 
Remediation: 
Enforce the principle of least privilege so that staff have the minimum level of access needed. 
Patch and update systems to protect against known malicious content. 
Use vulnerability scanning tools.

Vulnerability: IP addresses for domain servers are exposed 
Risk Rating: medium 
Description: A search using Recon-ng revealed the IP addresses of Megacorpone’s three NS (named servers). Recon-ng is a publicly available tool so bad actors would also be able to find this information. This may leave Megacorpone vulnerable to DNS poisoning or spoofing where users are directed away from their site and to a malicious site. 
Affected hosts: ns1.megacorpone.com, ns2.megacorpone.com, ns3.megacorpone.com Remediation: 
Make the IP addresses for these servers private 


Vulnerability: CVE vulnerabilities 
Risk Rating: medium 
Description: We ran a report using Shodan which identified potential vulnerabilities on Megacorpone’s apache servers
Affected hosts: apache servers 
Remediation: 
CVE are publicly known security flaws. 
We recommend that you learn more about them to identify if these vulnerabilities are present.



MITRE ATT&CK Navigator Map


[Using the MITRE ATT&CK Navigator, build out a map showing what techniques you’ve used so far. To do so, on the MITRE ATT&CK Navigator page, click “Create New Layer,” then “Enterprise,” and select each technique that you’ve used. Change the color of each selected technique to highlight it in yellow if it was successful, or in red if it was unsuccessful, as the following image shows:
 
 



When you’re done, be sure to download the chart as JSON by clicking the download icon, as the following image shows:



Remember, this report is not yet complete—we will finish it in the next module. 



The following completed MITRE ATT&CK navigator map shows all of the techniques and tactics that [SJAM] used throughout the assessment.



Legend:

Performed successfully
Failure to perform


[MITRE ATT&CK navigator map]

